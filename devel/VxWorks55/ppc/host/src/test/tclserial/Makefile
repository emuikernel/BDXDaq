# Makefile  - for tcl serial shared object
#
# Copyright 1997, Wind River Systems, Inc.
#
# modification history
# --------------------
# 01a,08sep97,dat  started modification history
#

.SUFFIXES:	.so .sl

include      	$(WIND_BASE)/host/include/make/generic.mh
include        	$(WIND_BASE)/host/include/make/$(HOST).mh

INCLUDES	= $(WIND_INC) $(TCLX_INC) $(WIND_SHARE_INC)

SERIAL_OBJS 	= tclserial.o pkgtclserial.o

FULL_SERIAL_OBJ	= $(patsubst %.o,$(HOST)/%.o,$(SERIAL_OBJS))

SH_SER_OBJS	= pkgtclserial.${SHLIB_EXT}

LOCAL_CFLAGS	= -DPORTABLE $(DYN_LK_FLAGS)

LOCAL_CLEAN	= $(WIND_BIN)/$(SH_SER_OBJS)

default:	lib $(SH_SER_OBJS)

.c.o:
	$(CC) $(STD_FLAGS) -c $< -o $@


%.$(SHLIB_EXT): $(FULL_SER_OBJ)
	$(SHARED_LD) $(SHARED_LDFLAGS) -o \
	    $(WIND_BIN)/$*.$(SHLIB_EXT) $(FULL_SERIAL_OBJ)

LIBRARIES	= TCL_SERIAL_LIB
PROGRAMS	= 
TESTS		= 
DOCS		= 

## Add special build targets and default here.

doc:

TCL_SERIAL_LIB:	$(FULL_SERIAL_OBJ)
	(cd $(HOST); $(AR) cru $@ $(SERIAL_OBJS); $(RANLIB) $@)

#	@echo ""

include        	$(WIND_BASE)/host/include/make/generic2.mh

## Dependencies below generated by compiler's handy -M flag.
